{% extends 'products/base.html' %}
{% load static %}

{%block title %}Profile{%endblock title %}

{% block css %}
    <link rel="stylesheet" href="{% static 'vendor/css/profile.css' %}">
{% endblock %}
{% block content %}
    <div class="container">
    <div class="row">
        <div class="col-lg-7">
            <h4 class="mt-3 mb-3">Profile{{messages.error}}</h4>
            {% if messages or form.non_field_errors %}
                        {% if messages%}
                            {% for i in messages %}
                                  <div class="alert {%if i.tags == 'error'%} alert-warning {% else %} alert-success {%endif%}
                                  alert-dismissible fade show" role="alert" style="margin-top: 50px;">
                                {{i}}
                            {%endfor%}
                            {%endif%}
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        {% endif %}
            <div class="col-lg-12 text-center">
                <img width="100" height="100"
                     src="{% if user.image %} {{ user.image.url }} {% else %} {% static 'vendor/img/users/default_avatar.jpg' %} {% endif %}"
                     class="img-thumbnail">
            </div>
            <form action="{% url 'profile' user.id %}" method="post" enctype = "multipart/form-data">
                {% csrf_token %}
                <div class="form-row">
                    <div class="col-lg-6">
                        <div class="form-group">
                            <label class="small mb-1" for="{{form.first_name.id_for_label}}">First name</label>
                            {{ form.first_name }}
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="form-group">
                            <label class="small mb-1" for="{{form.last_name.id_for_label}}">Last name</label>
                            {{form.last_name}}
                        </div>
                    </div>
                </div>
                <div class="form-row mb-2">
                    <div class="col-lg-12">
                        <div class="custom-file">
                            {{ form.image }}
                            <label class="custom-file-label" for="{{ form.image.id_for_label }}">Choose file</label>
                        </div>
                    </div>
                </div>
                <script>
    document.addEventListener('DOMContentLoaded', function () {
        var fileInput = document.querySelector('.custom-file-label'); // Замените '.custom-file-input' на ваш селектор

        fileInput.addEventListener('change', function () {
            var fileName = this.files[0].name;
            this.nextElementSibling.innerText = fileName;
        });
    });
</script>

                <div class="form-row">
                    <div class="col-lg-6">
                        <label class="small mb-1" for="{{form.username.id_for_label}}">Username</label>
                        {{form.username}}
                    </div>
                    <div class="col-lg-6">
                        <label class="small mb-1" for="{{form.email.id_for_label}}">Email</label>
                        {{form.email}}
                    </div>

                </div>
                <div class="form-row">
                  <div class="col-lg-6 text-center" style="margin-top: 10px;">
                    <button class="btn btn-info" type="button" onclick="toggleBlock('passwordBlock')">Change Password</button>

                  </div>

                  <div class="col-lg-6 text-center" style="margin-top: 10px;">
                    <button class="btn btn-info"  type="button" onclick="toggleBlock('emailBlock')">Change Email</button>
                  </div>
                </div>
                <div id="passwordBlock" style="display:none;" class="hiddenBlock">
                    <div class="form-row">
                        <div style="margin-left: 25%;" class="col-lg-6 text-center">
                            <label class="small mb-1" for="{{form.old_password.id_for_label}}">Password</label>
                            {{form.old_password}}
                        </div>
                    </div>
                     <div class="form-row">
                        <div class="col-lg-6">
                            <label class="small mb-1" for="{{form.password1.id_for_label}}">New password</label>
                            {{form.password1}}
                        </div>
                        <div class="col-lg-6">
                            <label class="small mb-1" for="{{form.password2.id_for_label}}">Confirm password</label>
                            {{form.password2}}
                        </div>

                     </div>
                    </div>

                <div id="emailBlock"  style="display:none;" class="hiddenBlock">
                      <div style="margin-left: 25%;" class="col-lg-6 text-center">
                        <label class="small mb-1" for="{{form.email.id_for_label}}">New Email</label>
                        {{form.new_email}}
                    </div>
                    </div>

                <div class="form-row">
                    <div class="col-lg-12" style="margin-top: 33px;">
                                <input class="btn btn-info btn-block" type="submit" value="Save">
                    </div>
                </div>
            </form>
        </div>
        <div class="col-lg-5">
          {% include 'users/basket.html' %}
        </div>
    </div>
</div>

{% endblock %}

